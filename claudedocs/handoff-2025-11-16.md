# プロジェクト引継ぎ - じゃんけんゲーム開発

**日付**: 2025-11-16
**フェーズ**: 設計完了、実装タスク生成待ち
**次回作業者へ**: このドキュメントから作業を再開してください

---

## プロジェクト概要

カードベースのじゃんけんゲーム(ブラウザ版MVP)の開発プロジェクト。

**コンセプト**:
- トランプ形式のカード(グー・チョキ・パー各2枚、計6枚の手札)
- コイン駆け引きシステム(初期3枚、0枚で敗北)
- プレイヤー vs コンピュータの1対1対戦
- 将来的にRust/Tauriでデスクトップアプリ化

**参照**: `game_spec.md` (プロジェクトルート)

---

## 現在の進捗状況

### ✅ 完了した作業

| フェーズ | ステータス | ファイル | 説明 |
|---------|-----------|---------|------|
| **仕様初期化** | ✅ 完了 | `.kiro/specs/janken-game/spec.json` | 仕様メタデータ |
| **要件定義** | ✅ 完了・承認済 | `.kiro/specs/janken-game/requirements.md` | EARS形式の要件定義(10要件領域) |
| **技術設計** | ✅ 完了・未承認 | `.kiro/specs/janken-game/design.md` | 技術アーキテクチャ設計 |
| **調査ログ** | ✅ 完了 | `.kiro/specs/janken-game/research.md` | 技術調査と設計決定記録 |

### 📋 次のステップ

1. **設計レビュー** (オプション - 推奨)
   ```bash
   /kiro:validate-design janken-game
   ```
   - 設計品質の対話的レビュー
   - 設計の妥当性確認

2. **実装タスク生成**
   ```bash
   /kiro:spec-tasks janken-game -y
   ```
   - 実装タスクの自動生成
   - TDD形式のタスク分解

3. **実装フェーズ**
   ```bash
   /kiro:spec-impl janken-game
   ```
   - タスクベースの実装実行

---

## 重要ファイルパス

### 仕様ディレクトリ
```
.kiro/specs/janken-game/
├── spec.json              # メタデータ (phase: design-generated)
├── requirements.md        # 要件定義書 (10要件、EARS形式)
├── design.md             # 技術設計書
└── research.md           # 調査ログと設計決定記録
```

### プロジェクトルート
```
game_spec.md              # ゲーム仕様概要 (オリジナル仕様)
claudedocs/handoff-2025-11-16.md  # 本引継ぎドキュメント
```

---

## 設計の要点

### アーキテクチャ

**選択パターン**: Component-based Architecture + Layered Design

```
Presentation Layer (UI)
  ├─ UIRenderer, CardComponent, DeckComponent, CoinComponent
Logic Layer
  ├─ GameController, JudgeService, AIPlayer
Data Layer
  ├─ GameState (Reactive Store), GameConfig
```

### 技術スタック

| レイヤ | 技術 | 理由 |
|-------|------|------|
| Frontend | Vanilla JavaScript (ES6+) | フレームワーク非依存、Tauri移行容易 |
| UI | HTML5 + CSS3 | 静止画要件でCanvas不要 |
| 状態管理 | Proxy-based Reactive Store | 軽量、リアクティブUI更新 |
| 将来移行 | Tauri 2.0 + Rust | Desktop版 (製品版) |

**設計の特徴**:
- フレームワーク非依存でTauri移行を考慮
- Reactive Storeパターンで状態管理
- モジュラー設計で拡張性確保(手札枚数、コイン数、多人数対戦)

### 主要コンポーネント

1. **GameState** (Data): ゲーム状態の集中管理、Proxy-based reactive
2. **GameController** (Logic): ゲームフロー制御、状態遷移管理
3. **JudgeService** (Logic): じゃんけん判定ロジック(純粋関数)
4. **AIPlayer** (Logic): コンピュータ戦略(MVP版はランダム)
5. **UIRenderer** (Presentation): メイン画面描画、状態購読

詳細は `design.md` を参照。

---

## 要件概要

### 10の要件領域

1. **ゲーム初期化**: 手札6枚、コイン3枚配布
2. **手札管理**: プレイヤー/AIの手札表示と管理
3. **カード選択**: 手札からの戦略的選択
4. **カード公開と勝敗判定**: じゃんけんルール適用
5. **コイン管理**: 勝敗によるコイン移動
6. **デッキ管理**: 使用済カードの可視化
7. **ゲーム終了条件**: コイン0または全手札使用
8. **UI表示要件**: ブラウザ画面レイアウト
9. **ゲームリセット**: 新規セッション開始
10. **拡張性要件**: パラメータ設定、多人数対戦対応

全要件はEARS形式で記述。詳細は `requirements.md` 参照。

---

## 調査で得られた重要知見

### 1. アーキテクチャ選択
- **Component-based > MVC/ECS**: カードゲームに最適
- **Vanilla JS > React/Vue**: MVP要件に軽量、Tauri移行容易
- **Reactive Store**: Proxyで自前実装、フレームワーク不要

### 2. 状態管理戦略
- JavaScript Proxyによるリアクティブシステム
- 状態変更の単一経路(setState)で整合性保証
- 購読パターンで自動UI更新

### 3. 勝敗判定アルゴリズム
- 引き分けチェック優先 + プレイヤー勝利条件
- 可読性重視(3種類のカードのみで最適化不要)

### 4. Tauri移行戦略
- フレームワーク非依存の静的HTML/CSS/JS構成
- `npx tauri init`で既存プロジェクトに追加可能
- Web版の変更なしでデスクトップアプリ化

### 5. 拡張性設計
- GameConfigでパラメータ集約(手札枚数、コイン数)
- Player配列化で多人数対戦対応準備
- モジュラー構成で機能追加容易

詳細は `research.md` 参照。

---

## 設計上の注意点

### 制約・前提条件

1. **ブラウザ対応**: ES6+ サポートブラウザ(Chrome, Firefox, Safari, Edge最新版)
2. **Proxy非対応ブラウザ**: IE11以下は未サポート(ターゲット外)
3. **静止画のみ**: カードアニメーションなし(MVP版)
4. **オフラインゲーム**: ネットワーク通信なし、セキュリティリスク最小

### リスクと緩和策

| リスク | 緩和策 |
|-------|-------|
| Proxy互換性問題 | ターゲットブラウザ確認、必要ならpolyfill |
| Tauri移行の複雑さ | 静的HTML構成維持、条件分岐で対応 |
| 多人数拡張時の大規模変更 | Player配列化、Turn管理抽象化を初期設計に含む |
| 状態同期バグ | Reactive store + 自動UI更新、単一経路の状態変更 |

---

## 実装時の推奨事項

### 開発順序

1. **Data Layer**: GameConfig, GameState (Reactive Store)
2. **Logic Layer**: JudgeService (純粋関数、テスト容易)
3. **Logic Layer**: GameController (フロー制御)
4. **Logic Layer**: AIPlayer (ランダム選択)
5. **Presentation Layer**: UIRenderer, Components
6. **Integration**: 全体統合とE2Eテスト

### テスト戦略

- **Unit Tests**: JudgeService(全9パターン), GameController, GameState
- **Integration Tests**: ゲーム初期化、1ラウンドフロー、終了フロー
- **E2E Tests**: ブラウザ操作テスト(Playwright推奨)

### コーディング規約

- **命名**: camelCase (JavaScript標準)
- **モジュール**: ES Modules (import/export)
- **型安全**: JSDoc型注釈(将来のTypeScript移行準備)
- **エラー処理**: Result型パターン (`{ok: boolean, value/error}`)

---

## よくある質問(FAQ)

**Q: なぜReact/Vueを使わないのか？**
A: MVP要件に過剰、Tauri移行でフレームワーク非依存が有利、バンドルサイズ最小化。

**Q: TypeScriptは使わないのか？**
A: MVP版はVanilla JS、将来的にTypeScript段階的移行可能。JSDocで型ヒント追加推奨。

**Q: Canvasを使わない理由は？**
A: 静止画要件でCanvas不要、HTML/CSSで十分。アニメーション要件発生時に検討。

**Q: AIの戦略は？**
A: MVP版はランダム選択、将来的に戦略ロジック追加可能な設計。

**Q: 多人数対戦はいつ実装？**
A: MVP版は2人対戦のみ、拡張性要件として設計に織り込み済み。Player配列化で対応準備完了。

---

## 次回作業開始時のチェックリスト

- [ ] 本引継ぎドキュメントを読む
- [ ] `game_spec.md` でゲーム仕様を再確認
- [ ] `requirements.md` で要件を確認
- [ ] `design.md` でアーキテクチャを理解
- [ ] `research.md` で設計決定の背景を把握
- [ ] 設計レビューまたはタスク生成コマンド実行

---

## 連絡事項

**重要な変更があった場合**:
- game_spec.mdの内容変更 → 要件・設計の再検討必要
- ブラウザ対応範囲の変更 → Proxy互換性再確認
- 技術スタック変更 → design.md, research.md更新

**質問・相談事項**:
本引継ぎドキュメントで不明点があれば、以下を確認:
1. `.kiro/specs/janken-game/` 内の各ドキュメント
2. Kiro仕様駆動開発ワークフロー: `CLAUDE.md`

---

## ドキュメント管理

- **本引継ぎ**: `claudedocs/handoff-2025-11-16.md`
- **更新ルール**: 次回作業時に新しい日付で引継ぎドキュメント作成
- **保持期間**: 実装完了まで保持、完了後アーカイブ

---

**作成日時**: 2025-11-16
**作成者**: Claude Code
**次回作業**: 設計レビューまたはタスク生成から開始
